baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
#write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_LC.txt", order = c(".rownames", ".wavelength"))
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/1_FTIR_raw/corrected_spectra_r.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
#write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_LC.txt", order = c(".rownames", ".wavelength"))
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/1_FTIR_raw/corrected_spectra_r.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_LC.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
#write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_LC.txt", order = c(".rownames", ".wavelength"))
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/1_FTIR_raw/corrected_spectra_r.txt", order = c(".rownames", ".wavelength"))
plot(spc)
plot(smooth)
plot(bl)
plot(bl_min)
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl)
#write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_LC.txt", order = c(".rownames", ".wavelength"))
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/1_FTIR_raw/corrected_spectra_r.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl)
wl = i2wl(bl_min)
corrected = as.wide.df(bl)
#write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_LC.txt", order = c(".rownames", ".wavelength"))
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/1_FTIR_raw/corrected_spectra_r.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl)
#write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_LC.txt", order = c(".rownames", ".wavelength"))
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/1_FTIR_raw/corrected_spectra_r.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
#write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_LC.txt", order = c(".rownames", ".wavelength"))
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/1_FTIR_raw/corrected_spectra_r.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_PET.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_WPET.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 3000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_WPET.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 3000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_LC.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 3300, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_LC.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 3300, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_LC.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 2500, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_LC.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 3000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_LC.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_LC.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_PET.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_WPET.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
#write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_LC.txt", order = c(".rownames", ".wavelength"))
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/1_FTIR_raw/corrected_spectra_r.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_WPET.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_LC.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_PET.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_LC.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_PET.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_WPET.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/1_FTIR_raw/corrected_spectra_r.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_WPET.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_PET.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_LC.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_PET.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_WPET.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/1_FTIR_raw/corrected_spectra_r.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 2000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/1_FTIR_raw/corrected_spectra_r.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/1_FTIR_raw/corrected_spectra_r.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_WPET.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_WPET.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_PET.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_LC.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_PET.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_WPET.txt", order = c(".rownames", ".wavelength"))
raw = py$raw
raw = as.matrix(raw)
spc = new("hyperSpec", spc = raw)
smooth = spc.loess(spc, seq(650, 4000, 1))
baselines <- spc.fit.poly.below(smooth)
bl = smooth - baselines
#bl_min <- sweep(bl, 2, apply(bl, 2, quantile, 0.01), "-")
bl_min <- sweep(bl, 1, apply(bl, 1, mean), "/")
plot(bl_min)
wl = i2wl(bl_min)
corrected = as.wide.df(bl_min)
write.txt.long(bl_min, file = "/Users/robynwright/Documents/OneDrive/Github/PET-Plastisphere/4_community_and_isolates/a_growth_and_FTIR/corrected_spectra_r_WPET.txt", order = c(".rownames", ".wavelength"))
